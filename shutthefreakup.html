<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The AI Companion</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #121212;
            color: #e0e0e0;
        }
        .container {
            text-align: center;
            padding: 40px;
            border-radius: 10px;
            background-color: #1e1e1e;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
            transition: box-shadow 0.3s ease, border 0.3s ease;
            border: 1px solid transparent;
        }
        h1 {
            font-size: 24px;
            margin-bottom: 20px;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            border-radius: 5px;
            border: none;
            background-color: #bb86fc;
            color: #121212;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.2s;
        }
        button:hover {
            background-color: #a362ff;
        }
        #message {
            margin-top: 20px;
            font-size: 28px;
            font-weight: bold;
            color: #cf6679;
            min-height: 40px; /* Prevents layout shift */
        }
        #status {
            margin-top: 15px;
            font-size: 16px;
            color: #aaa;
            min-height: 20px;
        }
        button:disabled {
            background-color: #444;
            cursor: not-allowed;
        }
        .container.angry {
            box-shadow: 0 4px 30px rgba(207, 102, 121, 0.7);
            border: 1px solid #cf6679;
        }
        .container.angry h1 {
            color: #cf6679;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Talk to the AI</h1>
        <button id="voiceBtn">Start Talking</button>
        <p id="status"></p>
        <p id="message"></p>
    </div>

    <script>
        const messageEl = document.getElementById('message');
        const voiceBtn = document.getElementById('voiceBtn');
        const statusEl = document.getElementById('status');
        const containerEl = document.querySelector('.container');

        let isListening = false;
        let isAngry = false;

        const narutoAngryResponses = [
            "You're gonna get a Rasengan to the face!",
            "Don't you dare underestimate me!",
            "I'm not giving up! That's not my style!",
            "You're more annoying than Sakura sometimes!",
            "Shadow Clone Jutsu!",
            "I'll show you what a real ninja can do!"
        ];

        const narutoCalmResponses = [
            "Believe it!",
            "I'm gonna be the next Hokage!",
            "Just you wait and see!",
            "Heh, piece of cake.",
            "Training time!",
            "I never go back on my word! That's my nindo, my ninja way!"
        ];

        // Function to make the AI speak
        function speak(text, isAngryVoice = false) {
            messageEl.textContent = text;
            if ('speechSynthesis' in window) {
                window.speechSynthesis.cancel(); // Stop any previous speech
                const utterance = new SpeechSynthesisUtterance(text);
                // Adjust pitch and rate to sound more like Naruto
                utterance.pitch = isAngryVoice ? 1.5 : 1.3; // Higher when angry
                utterance.rate = isAngryVoice ? 1.3 : 1.1; // Faster when angry
                window.speechSynthesis.speak(utterance);
            }
        }

        // --- Voice Recognition Logic ---
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

        if (SpeechRecognition) {
            const recognition = new SpeechRecognition();
            recognition.continuous = true; // Keep listening
            recognition.lang = 'en-US';

            voiceBtn.addEventListener('click', () => {
                if (isListening) {
                    recognition.stop();
                } else {
                    statusEl.textContent = "Initializing... Please allow microphone access.";
                    recognition.start();
                }
            });

            recognition.onstart = () => {
                isListening = true;
                statusEl.textContent = 'Listening...';
                voiceBtn.textContent = 'Stop Talking';
            };

            recognition.onend = () => {
                isListening = false;
                statusEl.textContent = 'Click "Start Talking" to begin.';
                voiceBtn.textContent = 'Start Talking';
            };

            recognition.onresult = (event) => {
                const transcript = event.results[event.results.length - 1][0].transcript.trim().toLowerCase();
                statusEl.textContent = `You said: "${transcript}"`;

                if (transcript.includes('67') || transcript.includes('sixty-seven' || transcript.includes('6 7')|| transcript.includes('six-seven'))) {
                    if (!isAngry) {
                        isAngry = true;
                        containerEl.classList.add('angry');
                        speak("Shut the fuck up!", true);
                    } 
              
            };

            recognition.onerror = (event) => {
                if (event.error === 'not-allowed') {
                    statusEl.textContent = "Error: Permission to use microphone was denied. Please allow it in your browser's settings.";
                } else {
                    statusEl.textContent = 'Error: Could not start recognition. ' + event.error;
                }
            };
            }
        } else {
            statusEl.textContent = "Sorry, your browser doesn't support voice recognition.";
            voiceBtn.disabled = true;
        }
    </script>
</body>
</html>